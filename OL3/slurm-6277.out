Matplotlib created a temporary cache directory at /tmp/matplotlib-49lkl6_7 because the default path (/home/jovyan/.cache/matplotlib) is not a writable directory; it is highly recommended to set the MPLCONFIGDIR environment variable to a writable directory, in particular to speed up the import of Matplotlib and to better support multiprocessing.
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
/opt/conda/lib/python3.11/site-packages/lightning/fabric/loggers/csv_logs.py:195: UserWarning: Experiment logs directory logs/OL3/relu exists and is not empty. Previous log files in this directory will be deleted when the new ones are saved!
  rank_zero_warn(
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]

  | Name       | Type               | Params
--------------------------------------------------
0 | projection | ConvTranspose2d    | 147   
1 | resnet     | ResNet             | 23.7 M
2 | model_acc  | MulticlassAccuracy | 0     
3 | model_loss | CrossEntropyLoss   | 0     
--------------------------------------------------
23.7 M    Trainable params
0         Non-trainable params
23.7 M    Total params
94.852    Total estimated model params size (MB)
NVIDIA GeForce RTX 2080 Ti
_CudaDeviceProperties(name='NVIDIA GeForce RTX 2080 Ti', major=7, minor=5, total_memory=11011MB, multi_processor_count=68)
Number of devices: 1
Files already downloaded and verified
Files already downloaded and verified
===============================================================================================
Layer (type:depth-idx)                        Output Shape              Param #
===============================================================================================
ResNet50                                      [1, 100]                  --
├─ConvTranspose2d: 1-1                        [1, 3, 128, 128]          147
├─ResNet: 1-2                                 [1, 100]                  --
│    └─Conv2d: 2-1                            [1, 64, 64, 64]           9,408
│    └─BatchNorm2d: 2-2                       [1, 64, 64, 64]           128
│    └─ReLU: 2-3                              [1, 64, 64, 64]           --
│    └─MaxPool2d: 2-4                         [1, 64, 32, 32]           --
│    └─Sequential: 2-5                        [1, 256, 32, 32]          --
│    │    └─Bottleneck: 3-1                   [1, 256, 32, 32]          --
│    │    │    └─Conv2d: 4-1                  [1, 64, 32, 32]           4,096
│    │    │    └─BatchNorm2d: 4-2             [1, 64, 32, 32]           128
│    │    │    └─ReLU: 4-3                    [1, 64, 32, 32]           --
│    │    │    └─Conv2d: 4-4                  [1, 64, 32, 32]           36,864
│    │    │    └─BatchNorm2d: 4-5             [1, 64, 32, 32]           128
│    │    │    └─ReLU: 4-6                    [1, 64, 32, 32]           --
│    │    │    └─Conv2d: 4-7                  [1, 256, 32, 32]          16,384
│    │    │    └─BatchNorm2d: 4-8             [1, 256, 32, 32]          512
│    │    │    └─Sequential: 4-9              [1, 256, 32, 32]          16,896
│    │    │    └─ReLU: 4-10                   [1, 256, 32, 32]          --
│    │    └─Bottleneck: 3-2                   [1, 256, 32, 32]          --
│    │    │    └─Conv2d: 4-11                 [1, 64, 32, 32]           16,384
│    │    │    └─BatchNorm2d: 4-12            [1, 64, 32, 32]           128
│    │    │    └─ReLU: 4-13                   [1, 64, 32, 32]           --
│    │    │    └─Conv2d: 4-14                 [1, 64, 32, 32]           36,864
│    │    │    └─BatchNorm2d: 4-15            [1, 64, 32, 32]           128
│    │    │    └─ReLU: 4-16                   [1, 64, 32, 32]           --
│    │    │    └─Conv2d: 4-17                 [1, 256, 32, 32]          16,384
│    │    │    └─BatchNorm2d: 4-18            [1, 256, 32, 32]          512
│    │    │    └─ReLU: 4-19                   [1, 256, 32, 32]          --
│    │    └─Bottleneck: 3-3                   [1, 256, 32, 32]          --
│    │    │    └─Conv2d: 4-20                 [1, 64, 32, 32]           16,384
│    │    │    └─BatchNorm2d: 4-21            [1, 64, 32, 32]           128
│    │    │    └─ReLU: 4-22                   [1, 64, 32, 32]           --
│    │    │    └─Conv2d: 4-23                 [1, 64, 32, 32]           36,864
│    │    │    └─BatchNorm2d: 4-24            [1, 64, 32, 32]           128
│    │    │    └─ReLU: 4-25                   [1, 64, 32, 32]           --
│    │    │    └─Conv2d: 4-26                 [1, 256, 32, 32]          16,384
│    │    │    └─BatchNorm2d: 4-27            [1, 256, 32, 32]          512
│    │    │    └─ReLU: 4-28                   [1, 256, 32, 32]          --
│    └─Sequential: 2-6                        [1, 512, 16, 16]          --
│    │    └─Bottleneck: 3-4                   [1, 512, 16, 16]          --
│    │    │    └─Conv2d: 4-29                 [1, 128, 32, 32]          32,768
│    │    │    └─BatchNorm2d: 4-30            [1, 128, 32, 32]          256
│    │    │    └─ReLU: 4-31                   [1, 128, 32, 32]          --
│    │    │    └─Conv2d: 4-32                 [1, 128, 16, 16]          147,456
│    │    │    └─BatchNorm2d: 4-33            [1, 128, 16, 16]          256
│    │    │    └─ReLU: 4-34                   [1, 128, 16, 16]          --
│    │    │    └─Conv2d: 4-35                 [1, 512, 16, 16]          65,536
│    │    │    └─BatchNorm2d: 4-36            [1, 512, 16, 16]          1,024
│    │    │    └─Sequential: 4-37             [1, 512, 16, 16]          132,096
│    │    │    └─ReLU: 4-38                   [1, 512, 16, 16]          --
│    │    └─Bottleneck: 3-5                   [1, 512, 16, 16]          --
│    │    │    └─Conv2d: 4-39                 [1, 128, 16, 16]          65,536
│    │    │    └─BatchNorm2d: 4-40            [1, 128, 16, 16]          256
│    │    │    └─ReLU: 4-41                   [1, 128, 16, 16]          --
│    │    │    └─Conv2d: 4-42                 [1, 128, 16, 16]          147,456
│    │    │    └─BatchNorm2d: 4-43            [1, 128, 16, 16]          256
│    │    │    └─ReLU: 4-44                   [1, 128, 16, 16]          --
│    │    │    └─Conv2d: 4-45                 [1, 512, 16, 16]          65,536
│    │    │    └─BatchNorm2d: 4-46            [1, 512, 16, 16]          1,024
│    │    │    └─ReLU: 4-47                   [1, 512, 16, 16]          --
│    │    └─Bottleneck: 3-6                   [1, 512, 16, 16]          --
│    │    │    └─Conv2d: 4-48                 [1, 128, 16, 16]          65,536
│    │    │    └─BatchNorm2d: 4-49            [1, 128, 16, 16]          256
│    │    │    └─ReLU: 4-50                   [1, 128, 16, 16]          --
│    │    │    └─Conv2d: 4-51                 [1, 128, 16, 16]          147,456
│    │    │    └─BatchNorm2d: 4-52            [1, 128, 16, 16]          256
│    │    │    └─ReLU: 4-53                   [1, 128, 16, 16]          --
│    │    │    └─Conv2d: 4-54                 [1, 512, 16, 16]          65,536
│    │    │    └─BatchNorm2d: 4-55            [1, 512, 16, 16]          1,024
│    │    │    └─ReLU: 4-56                   [1, 512, 16, 16]          --
│    │    └─Bottleneck: 3-7                   [1, 512, 16, 16]          --
│    │    │    └─Conv2d: 4-57                 [1, 128, 16, 16]          65,536
│    │    │    └─BatchNorm2d: 4-58            [1, 128, 16, 16]          256
│    │    │    └─ReLU: 4-59                   [1, 128, 16, 16]          --
│    │    │    └─Conv2d: 4-60                 [1, 128, 16, 16]          147,456
│    │    │    └─BatchNorm2d: 4-61            [1, 128, 16, 16]          256
│    │    │    └─ReLU: 4-62                   [1, 128, 16, 16]          --
│    │    │    └─Conv2d: 4-63                 [1, 512, 16, 16]          65,536
│    │    │    └─BatchNorm2d: 4-64            [1, 512, 16, 16]          1,024
│    │    │    └─ReLU: 4-65                   [1, 512, 16, 16]          --
│    └─Sequential: 2-7                        [1, 1024, 8, 8]           --
│    │    └─Bottleneck: 3-8                   [1, 1024, 8, 8]           --
│    │    │    └─Conv2d: 4-66                 [1, 256, 16, 16]          131,072
│    │    │    └─BatchNorm2d: 4-67            [1, 256, 16, 16]          512
│    │    │    └─ReLU: 4-68                   [1, 256, 16, 16]          --
│    │    │    └─Conv2d: 4-69                 [1, 256, 8, 8]            589,824
│    │    │    └─BatchNorm2d: 4-70            [1, 256, 8, 8]            512
│    │    │    └─ReLU: 4-71                   [1, 256, 8, 8]            --
│    │    │    └─Conv2d: 4-72                 [1, 1024, 8, 8]           262,144
│    │    │    └─BatchNorm2d: 4-73            [1, 1024, 8, 8]           2,048
│    │    │    └─Sequential: 4-74             [1, 1024, 8, 8]           526,336
│    │    │    └─ReLU: 4-75                   [1, 1024, 8, 8]           --
│    │    └─Bottleneck: 3-9                   [1, 1024, 8, 8]           --
│    │    │    └─Conv2d: 4-76                 [1, 256, 8, 8]            262,144
│    │    │    └─BatchNorm2d: 4-77            [1, 256, 8, 8]            512
│    │    │    └─ReLU: 4-78                   [1, 256, 8, 8]            --
│    │    │    └─Conv2d: 4-79                 [1, 256, 8, 8]            589,824
│    │    │    └─BatchNorm2d: 4-80            [1, 256, 8, 8]            512
│    │    │    └─ReLU: 4-81                   [1, 256, 8, 8]            --
│    │    │    └─Conv2d: 4-82                 [1, 1024, 8, 8]           262,144
│    │    │    └─BatchNorm2d: 4-83            [1, 1024, 8, 8]           2,048
│    │    │    └─ReLU: 4-84                   [1, 1024, 8, 8]           --
│    │    └─Bottleneck: 3-10                  [1, 1024, 8, 8]           --
│    │    │    └─Conv2d: 4-85                 [1, 256, 8, 8]            262,144
│    │    │    └─BatchNorm2d: 4-86            [1, 256, 8, 8]            512
│    │    │    └─ReLU: 4-87                   [1, 256, 8, 8]            --
│    │    │    └─Conv2d: 4-88                 [1, 256, 8, 8]            589,824
│    │    │    └─BatchNorm2d: 4-89            [1, 256, 8, 8]            512
│    │    │    └─ReLU: 4-90                   [1, 256, 8, 8]            --
│    │    │    └─Conv2d: 4-91                 [1, 1024, 8, 8]           262,144
│    │    │    └─BatchNorm2d: 4-92            [1, 1024, 8, 8]           2,048
│    │    │    └─ReLU: 4-93                   [1, 1024, 8, 8]           --
│    │    └─Bottleneck: 3-11                  [1, 1024, 8, 8]           --
│    │    │    └─Conv2d: 4-94                 [1, 256, 8, 8]            262,144
│    │    │    └─BatchNorm2d: 4-95            [1, 256, 8, 8]            512
│    │    │    └─ReLU: 4-96                   [1, 256, 8, 8]            --
│    │    │    └─Conv2d: 4-97                 [1, 256, 8, 8]            589,824
│    │    │    └─BatchNorm2d: 4-98            [1, 256, 8, 8]            512
│    │    │    └─ReLU: 4-99                   [1, 256, 8, 8]            --
│    │    │    └─Conv2d: 4-100                [1, 1024, 8, 8]           262,144
│    │    │    └─BatchNorm2d: 4-101           [1, 1024, 8, 8]           2,048
│    │    │    └─ReLU: 4-102                  [1, 1024, 8, 8]           --
│    │    └─Bottleneck: 3-12                  [1, 1024, 8, 8]           --
│    │    │    └─Conv2d: 4-103                [1, 256, 8, 8]            262,144
│    │    │    └─BatchNorm2d: 4-104           [1, 256, 8, 8]            512
│    │    │    └─ReLU: 4-105                  [1, 256, 8, 8]            --
│    │    │    └─Conv2d: 4-106                [1, 256, 8, 8]            589,824
│    │    │    └─BatchNorm2d: 4-107           [1, 256, 8, 8]            512
│    │    │    └─ReLU: 4-108                  [1, 256, 8, 8]            --
│    │    │    └─Conv2d: 4-109                [1, 1024, 8, 8]           262,144
│    │    │    └─BatchNorm2d: 4-110           [1, 1024, 8, 8]           2,048
│    │    │    └─ReLU: 4-111                  [1, 1024, 8, 8]           --
│    │    └─Bottleneck: 3-13                  [1, 1024, 8, 8]           --
│    │    │    └─Conv2d: 4-112                [1, 256, 8, 8]            262,144
│    │    │    └─BatchNorm2d: 4-113           [1, 256, 8, 8]            512
│    │    │    └─ReLU: 4-114                  [1, 256, 8, 8]            --
│    │    │    └─Conv2d: 4-115                [1, 256, 8, 8]            589,824
│    │    │    └─BatchNorm2d: 4-116           [1, 256, 8, 8]            512
│    │    │    └─ReLU: 4-117                  [1, 256, 8, 8]            --
│    │    │    └─Conv2d: 4-118                [1, 1024, 8, 8]           262,144
│    │    │    └─BatchNorm2d: 4-119           [1, 1024, 8, 8]           2,048
│    │    │    └─ReLU: 4-120                  [1, 1024, 8, 8]           --
│    └─Sequential: 2-8                        [1, 2048, 4, 4]           --
│    │    └─Bottleneck: 3-14                  [1, 2048, 4, 4]           --
│    │    │    └─Conv2d: 4-121                [1, 512, 8, 8]            524,288
│    │    │    └─BatchNorm2d: 4-122           [1, 512, 8, 8]            1,024
│    │    │    └─ReLU: 4-123                  [1, 512, 8, 8]            --
│    │    │    └─Conv2d: 4-124                [1, 512, 4, 4]            2,359,296
│    │    │    └─BatchNorm2d: 4-125           [1, 512, 4, 4]            1,024
│    │    │    └─ReLU: 4-126                  [1, 512, 4, 4]            --
│    │    │    └─Conv2d: 4-127                [1, 2048, 4, 4]           1,048,576
│    │    │    └─BatchNorm2d: 4-128           [1, 2048, 4, 4]           4,096
│    │    │    └─Sequential: 4-129            [1, 2048, 4, 4]           2,101,248
│    │    │    └─ReLU: 4-130                  [1, 2048, 4, 4]           --
│    │    └─Bottleneck: 3-15                  [1, 2048, 4, 4]           --
│    │    │    └─Conv2d: 4-131                [1, 512, 4, 4]            1,048,576
│    │    │    └─BatchNorm2d: 4-132           [1, 512, 4, 4]            1,024
│    │    │    └─ReLU: 4-133                  [1, 512, 4, 4]            --
│    │    │    └─Conv2d: 4-134                [1, 512, 4, 4]            2,359,296
│    │    │    └─BatchNorm2d: 4-135           [1, 512, 4, 4]            1,024
│    │    │    └─ReLU: 4-136                  [1, 512, 4, 4]            --
│    │    │    └─Conv2d: 4-137                [1, 2048, 4, 4]           1,048,576
│    │    │    └─BatchNorm2d: 4-138           [1, 2048, 4, 4]           4,096
│    │    │    └─ReLU: 4-139                  [1, 2048, 4, 4]           --
│    │    └─Bottleneck: 3-16                  [1, 2048, 4, 4]           --
│    │    │    └─Conv2d: 4-140                [1, 512, 4, 4]            1,048,576
│    │    │    └─BatchNorm2d: 4-141           [1, 512, 4, 4]            1,024
│    │    │    └─ReLU: 4-142                  [1, 512, 4, 4]            --
│    │    │    └─Conv2d: 4-143                [1, 512, 4, 4]            2,359,296
│    │    │    └─BatchNorm2d: 4-144           [1, 512, 4, 4]            1,024
│    │    │    └─ReLU: 4-145                  [1, 512, 4, 4]            --
│    │    │    └─Conv2d: 4-146                [1, 2048, 4, 4]           1,048,576
│    │    │    └─BatchNorm2d: 4-147           [1, 2048, 4, 4]           4,096
│    │    │    └─ReLU: 4-148                  [1, 2048, 4, 4]           --
│    └─AdaptiveAvgPool2d: 2-9                 [1, 2048, 1, 1]           --
│    └─Linear: 2-10                           [1, 100]                  204,900
===============================================================================================
Total params: 23,713,079
Trainable params: 23,713,079
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 1.34
===============================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 58.46
Params size (MB): 94.85
Estimated Total Size (MB): 153.32
===============================================================================================
Sanity Checking: 0it [00:00, ?it/s]/opt/conda/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:442: PossibleUserWarning: The dataloader, val_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 20 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
Sanity Checking:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0:   0%|          | 0/2 [00:00<?, ?it/s]Sanity Checking DataLoader 0: 100%|██████████| 2/2 [00:00<00:00,  5.57it/s]                                                                           /opt/conda/lib/python3.11/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:442: PossibleUserWarning: The dataloader, train_dataloader, does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` (try 20 which is the number of cpus on this machine) in the `DataLoader` init to improve performance.
  rank_zero_warn(
Training: 0it [00:00, ?it/s]Training:   0%|          | 0/200 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/200 [00:00<?, ?it/s] Epoch 0:  25%|██▌       | 50/200 [00:17<00:53,  2.79it/s]Epoch 0:  25%|██▌       | 50/200 [00:17<00:53,  2.79it/s, v_num=relu]Epoch 0:  50%|█████     | 100/200 [00:35<00:35,  2.81it/s, v_num=relu]Epoch 0:  50%|█████     | 100/200 [00:35<00:35,  2.81it/s, v_num=relu]Epoch 0:  75%|███████▌  | 150/200 [00:53<00:17,  2.82it/s, v_num=relu]Epoch 0:  75%|███████▌  | 150/200 [00:53<00:17,  2.82it/s, v_num=relu]Epoch 0: 100%|██████████| 200/200 [01:10<00:00,  2.83it/s, v_num=relu]Epoch 0: 100%|██████████| 200/200 [01:10<00:00,  2.83it/s, v_num=relu]
Validation: 0it [00:00, ?it/s][A
Validation:   0%|          | 0/40 [00:00<?, ?it/s][A
Validation DataLoader 0:   0%|          | 0/40 [00:00<?, ?it/s][A
Validation DataLoader 0: 100%|██████████| 40/40 [00:03<00:00, 10.14it/s][AEpoch 0: 100%|██████████| 200/200 [01:14<00:00,  2.67it/s, v_num=relu]
                                                                        [AEpoch 0: 100%|██████████| 200/200 [01:14<00:00,  2.67it/s, v_num=relu]Epoch 0:   0%|          | 0/200 [00:00<?, ?it/s, v_num=relu]          Epoch 1:   0%|          | 0/200 [00:00<?, ?it/s, v_num=relu]Epoch 1:  25%|██▌       | 50/200 [00:17<00:52,  2.85it/s, v_num=relu]Epoch 1:  25%|██▌       | 50/200 [00:17<00:52,  2.85it/s, v_num=relu]